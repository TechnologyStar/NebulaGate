# Heimdall Authentication Gateway Configuration
# Add these environment variables to your .env file or system environment

# =============================================================================
# AUTHENTICATION SETTINGS
# =============================================================================

# Enable/disable Heimdall authentication (default: true)
HEIMDALL_AUTH_ENABLED=true

# API key validation using existing token system (default: true)
HEIMDALL_API_KEY_VALIDATION=true

# JWT token validation (default: false)
HEIMDALL_JWT_VALIDATION=false

# Mutual TLS certificate validation (default: false)
HEIMDALL_MUTUAL_TLS_VALIDATION=false

# JWT secret for token signing/verification (required if JWT validation enabled)
HEIMDALL_JWT_SECRET=your-super-secret-jwt-key-here

# JWT signing method (HS256, RS256, etc.) (default: HS256)
HEIMDALL_JWT_SIGNING_METHOD=HS256

# =============================================================================
# REQUEST VALIDATION SETTINGS
# =============================================================================

# Enable JSON schema validation (default: true)
HEIMDALL_SCHEMA_VALIDATION=true

# Enable replay attack protection (default: true)
HEIMDALL_REPLAY_PROTECTION=true

# Replay protection time window (default: 5m)
HEIMDALL_REPLAY_WINDOW=5m

# =============================================================================
# RATE LIMITING SETTINGS
# =============================================================================

# Enable rate limiting (default: true)
HEIMDALL_RATE_LIMIT_ENABLED=true

# Per-token rate limit per window (default: 100)
HEIMDALL_PER_KEY_RATE_LIMIT=100

# Per-IP rate limit per window (default: 200)
HEIMDALL_PER_IP_RATE_LIMIT=200

# Rate limiting time window (default: 1m)
HEIMDALL_RATE_LIMIT_WINDOW=1m

# =============================================================================
# AUDIT LOGGING SETTINGS
# =============================================================================

# Enable comprehensive audit logging (default: true)
HEIMDALL_AUDIT_LOGGING_ENABLED=true

# Truncate request payloads in logs (default: true)
HEIMDALL_LOG_PAYLOAD_TRUNCATE=true

# Maximum payload size to log in bytes (default: 1024)
HEIMDALL_MAX_PAYLOAD_SIZE=1024

# =============================================================================
# EXAMPLE CONFIGURATIONS
# =============================================================================

# Development configuration:
# HEIMDALL_AUTH_ENABLED=true
# HEIMDALL_API_KEY_VALIDATION=true
# HEIMDALL_JWT_VALIDATION=false
# HEIMDALL_MUTUAL_TLS_VALIDATION=false
# HEIMDALL_SCHEMA_VALIDATION=true
# HEIMDALL_REPLAY_PROTECTION=false
# HEIMDALL_RATE_LIMIT_ENABLED=false
# HEIMDALL_AUDIT_LOGGING_ENABLED=true

# Production configuration with high security:
# HEIMDALL_AUTH_ENABLED=true
# HEIMDALL_API_KEY_VALIDATION=true
# HEIMDALL_JWT_VALIDATION=true
# HEIMDALL_MUTUAL_TLS_VALIDATION=true
# HEIMDALL_JWT_SECRET=your-production-secret-key
# HEIMDALL_SCHEMA_VALIDATION=true
# HEIMDALL_REPLAY_PROTECTION=true
# HEIMDALL_REPLAY_WINDOW=5m
# HEIMDALL_RATE_LIMIT_ENABLED=true
# HEIMDALL_PER_KEY_RATE_LIMIT=50
# HEIMDALL_PER_IP_RATE_LIMIT=100
# HEIMDALL_RATE_LIMIT_WINDOW=1m
# HEIMDALL_AUDIT_LOGGING_ENABLED=true
# HEIMDALL_LOG_PAYLOAD_TRUNCATE=true
# HEIMDALL_MAX_PAYLOAD_SIZE=512

# High throughput configuration:
# HEIMDALL_AUTH_ENABLED=true
# HEIMDALL_API_KEY_VALIDATION=true
# HEIMDALL_JWT_VALIDATION=false
# HEIMDALL_MUTUAL_TLS_VALIDATION=false
# HEIMDALL_SCHEMA_VALIDATION=false
# HEIMDALL_REPLAY_PROTECTION=false
# HEIMDALL_RATE_LIMIT_ENABLED=true
# HEIMDALL_PER_KEY_RATE_LIMIT=1000
# HEIMDALL_PER_IP_RATE_LIMIT=2000
# HEIMDALL_RATE_LIMIT_WINDOW=1m
# HEIMDALL_AUDIT_LOGGING_ENABLED=false